import{_ as M,Q as D,a4 as R,r as U,a as w,f as B,B as P,t as y,ac as V,v as $,e as c,c as H,o as j,b as l,d as n,w as i,l as p,y as A,z as m,ad as L,ae as Q}from"./index-CwZtB3M4.js";import{T as E}from"./index-DxOTm2Lt.js";import"./SettingOutlined-C8eYJqIM.js";const J={class:"my_news_center"},O=["onClick"],q={class:"modal-content"},G={class:"modal-row"},K={class:"modal-value"},W={class:"modal-row"},X={class:"modal-value"},Y={class:"modal-row"},Z={class:"modal-value"},aa=["innerHTML"],ea="查看详情",ta={__name:"mynews",emits:["search","success","export"],setup(sa,{emit:la}){const S=D(),{isDomFullscreen:oa}=R(S),e=U({value:"",msgCategory:"null",readFlag:"0",loading:!1,dataSource:[],params:{total:0,pageNo:1,pageSize:50,column:"createTime",order:"desc",logType:1,titile:void 0,msgCategory:void 0,readFlag:"0"}}),g=w(!1),o=w({}),_=B(),b=t=>{let a=(t==null?void 0:t.anntId)||null;L({anntId:a}).then(d=>{r(),Q({anntId:a})}),o.value=t,g.value=!0},x=()=>{let t="";if(o.value&&o.value.msgContent){const a=o.value.msgContent.match(/<h3[^>]*>.*?（([\s\S]*?)）.*?<\/h3>/i);a&&a[1]&&(t=a[1].trim())}t?(_.push(`/project-detail/${encodeURIComponent(t)}`),g.value=!1):_.push("/gy/industry")},z=P(()=>!o.value||!o.value.msgContent?"":o.value.msgContent.replace(/<a[^>]*>\s*点击查看详情\s*<\/a>|<span[^>]*>\s*点击查看详情\s*<\/span>|<div[^>]*>\s*点击查看详情\s*<\/div>|点击查看详情/g,""));y(()=>e.msgCategory,t=>{e.params.pageNo=1,e.params.msgCategory=t==="null"?void 0:t,r()}),y(()=>e.readFlag,t=>{e.params.pageNo=1,e.params.readFlag=t,r()});const f=t=>{e.params.pageNo=1,e.params.titile=t||void 0,r()},r=()=>{e.loading=!0,V({pageNo:e.params.pageNo,pageSize:e.params.pageSize,column:e.params.column,order:e.params.order,logType:e.params.logType,titile:e.params.titile,msgCategory:e.params.msgCategory,readFlag:e.params.readFlag}).then(t=>{var a,d;e.dataSource=((a=t==null?void 0:t.result)==null?void 0:a.records)||[],e.params.total=((d=t==null?void 0:t.result)==null?void 0:d.total)||0,e.loading=!1}).catch(()=>{e.loading=!1}).finally(()=>{e.loading=!1})},N=(t,a)=>{e.params.pageNo=t,e.params.pageSize=a,r()},T=(t,a)=>{e.params.pageNo=1,e.params.pageSize=a,r()},F=({sorter:t})=>{t&&t.field&&(e.params.column=t.field,e.params.order=t.order==="ascend"?"asc":"desc",e.params.pageNo=1,r())},I=()=>[{title:"内容",dataIndex:"titile",width:100,align:"center",resizable:!0,sorter:!0,slot:"titile"},{title:"消息类型",dataIndex:"msgCategory",width:80,resizable:!0,sorter:!0,align:"center",customRender:({text:t})=>({1:"通知公告",2:"系统消息",3:"行业变动",4:"项目变动"})[t]||t},{title:"来源",dataIndex:"sender",resizable:!0,align:"center",sorter:!0,width:80},{title:"发布时间",dataIndex:"sendTime",resizable:!0,sorter:!0,align:"center",width:80},{title:"阅读状态",dataIndex:"readFlag",resizable:!0,align:"center",sorter:!0,width:80,slot:"readFlag"}];return $(()=>{r()}),(t,a)=>{const d=c("a-input-search"),u=c("a-select-option"),C=c("a-select"),k=c("a-modal");return j(),H("div",J,[l("div",null,[n(d,{value:e.value,"onUpdate:value":a[0]||(a[0]=s=>e.value=s),placeholder:"全文搜索",style:{width:"300px"},onSearch:f,allowClear:""},null,8,["value"]),n(C,{value:e.msgCategory,"onUpdate:value":a[1]||(a[1]=s=>e.msgCategory=s),style:{width:"160px",height:"36px",margin:"0 18px"}},{default:i(()=>[n(u,{value:"null"},{default:i(()=>a[5]||(a[5]=[p("所有类型")])),_:1,__:[5]}),n(u,{value:"4"},{default:i(()=>a[6]||(a[6]=[p("项目变动")])),_:1,__:[6]}),n(u,{value:"3"},{default:i(()=>a[7]||(a[7]=[p("行业变动")])),_:1,__:[7]})]),_:1},8,["value"]),n(C,{value:e.readFlag,"onUpdate:value":a[2]||(a[2]=s=>e.readFlag=s),style:{width:"160px",height:"36px"}},{default:i(()=>[n(u,{value:"0"},{default:i(()=>a[8]||(a[8]=[p("未读")])),_:1,__:[8]}),n(u,{value:"1"},{default:i(()=>a[9]||(a[9]=[p("已读")])),_:1,__:[9]})]),_:1},8,["value"])]),n(E,{tableProps:{scrollToFirstRowOnChange:!0,loading:e.loading,pagination:!1,dataSource:e.dataSource,columns:I(),bordered:!0},isShowColumnSetting:!1,isFixedMaxHeight:!0,pagination:{total:e.params.total,current:e.params.pageNo,pageSize:e.params.pageSize,showTotal:s=>`共 ${s} 条数据`,showSizeChanger:!0,showQuickJumper:!0,onChange:N,onShowSizeChange:T},onSearch:f,onChange:F},{titile:i(({record:s})=>[l("span",{class:"clickable-title",onClick:v=>b(s)},m(s.titile),9,O)]),readFlag:i(({text:s})=>[l("span",{class:A(["read-flag",s===0?"unread":"read"])},m(s===0?"未读":"已读"),3)]),_:1},8,["tableProps","pagination"]),n(k,{visible:g.value,"onUpdate:visible":a[4]||(a[4]=s=>g.value=s),footer:null,title:ea,width:"480px",wrapClassName:"custom-detail-modal"},{default:i(()=>{var s,v,h;return[l("div",q,[l("div",G,[a[10]||(a[10]=l("span",{class:"modal-label"},"内容标题：",-1)),l("span",K,m((s=o.value)==null?void 0:s.titile),1)]),l("div",W,[a[11]||(a[11]=l("span",{class:"modal-label"},"发布人：",-1)),l("span",X,m((v=o.value)==null?void 0:v.sender),1)]),l("div",Y,[a[12]||(a[12]=l("span",{class:"modal-label"},"发布时间：",-1)),l("span",Z,m((h=o.value)==null?void 0:h.sendTime),1)]),a[13]||(a[13]=l("div",{class:"modal-row"},[l("span",{class:"modal-label"},"内容：")],-1)),l("div",{class:"modal-content-html",innerHTML:z.value},null,8,aa),l("a",{class:"manual-detail-link",onClick:a[3]||(a[3]=na=>x(o.value))}," 点击查看详情 ")])]}),_:1},8,["visible"])])}}},ua=M(ta,[["__scopeId","data-v-f1ca1a48"]]);export{ua as default};
