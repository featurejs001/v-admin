const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/excelPreProcessor-Tf4uxreI.js","assets/index-DgoLVYM5.js","assets/index-DTDi_6k8.css"])))=>i.map(i=>d[i]);
import{L as Y,_ as ie,r as oe,t as ue,e as k,c as _,o as m,d as y,w as x,j as b,b as E,F as te,x as se,i as W,l as O,z as N,A as R,y as ne,M as ee,H as me,a0 as fe,u as ge,a4 as ve,v as ye,C as _e,a5 as he,a6 as Le,G as ae,p as xe,a7 as Te,a8 as ke,K as we}from"./index-DgoLVYM5.js";import{v as Ee,L as Me,M as Ae,N as Ie,O as Fe,u as Pe,a as Ce,E as Be,F as be,g as X}from"./pinyin-OA7Wrzh0.js";import{I as Oe,R as je,E as $e,_ as He,a as Se,b as le,c as De}from"./fullScreen-i-jRbH7j.js";import{U as Ne}from"./UploadOutlined-vLwOc4rs.js";import{p as Re,t as qe,s as Ue,h as Ve,i as ce,j as de,k as pe,l as ze,n as We}from"./areaDataUtil-DFEcL7pU.js";async function Ge(F){console.log("预处理项目数据");try{const{preProcessExcelFile:u}=await Y(async()=>{const{preProcessExcelFile:M}=await import("./excelPreProcessor-Tf4uxreI.js");return{preProcessExcelFile:M}},__vite__mapDeps([0,1,2])),t=await u(F,{expectedHeaders:["三级赛道","项目","项目主体","项目阶段","跟进阶段","融资窗口开始时间","融资窗口结束时间","其他人","别名"],keyColumnIndex:1,ignoreEmptyTrailingRows:!0,checkUtf8Encoding:!0});return t.success?(console.log("项目数据解析结果:",t.data),Promise.resolve(t.data)):Promise.reject(new Error(t.errorMessage))}catch(u){return console.error("解析Excel文件失败:",u),Promise.reject(u)}}async function Je(F){console.log("预处理投资事件数据");try{const{preProcessExcelFile:u}=await Y(async()=>{const{preProcessExcelFile:M}=await import("./excelPreProcessor-Tf4uxreI.js");return{preProcessExcelFile:M}},__vite__mapDeps([0,1,2])),t=await u(F,{expectedHeaders:["项目","投资时间","轮次","金额","投资方"],keyColumnIndex:0,ignoreEmptyTrailingRows:!0,checkUtf8Encoding:!0});return t.success?(console.log("投资事件数据解析结果:",t.data),Promise.resolve(t.data)):Promise.reject(new Error(t.errorMessage))}catch(u){return console.error("解析Excel文件失败:",u),Promise.reject(u)}}async function Qe(F){console.log("预处理备注和飞书链接数据");try{const{preProcessExcelFile:u}=await Y(async()=>{const{preProcessExcelFile:M}=await import("./excelPreProcessor-Tf4uxreI.js");return{preProcessExcelFile:M}},__vite__mapDeps([0,1,2])),t=await u(F,{expectedHeaders:["项目","跟进","备注","飞书链接"],keyColumnIndex:0,ignoreEmptyTrailingRows:!0,checkUtf8Encoding:!0});return t.success?(console.log("备注和飞书链接数据解析结果:",t.data),Promise.resolve(t.data)):Promise.reject(new Error(t.errorMessage))}catch(u){return console.error("解析Excel文件失败:",u),Promise.reject(u)}}async function Xe(F){console.log("预处理第三方项目数据");try{const{preProcessExcelFile:u}=await Y(async()=>{const{preProcessExcelFile:M}=await import("./excelPreProcessor-Tf4uxreI.js");return{preProcessExcelFile:M}},__vite__mapDeps([0,1,2])),t=await u(F,{expectedHeaders:["项目","项目简介","成立时间","省市区","官网","第三方链接"],keyColumnIndex:0,ignoreEmptyTrailingRows:!0,checkUtf8Encoding:!0});return t.success?(console.log("第三方项目数据解析结果:",t.data),Promise.resolve(t.data)):Promise.reject(new Error(t.errorMessage))}catch(u){return console.error("解析Excel文件失败:",u),Promise.reject(u)}}const Ye={class:"model-container"},Ze={style:{padding:"30px 30px 0",width:"100%"}},Ke={style:{margin:"30px 0"},class:"action-container"},et={key:0},tt={key:1},st={key:2},nt={key:0,style:{color:"red"}},it={style:{"margin-top":"20px"}},ot={__name:"import",emits:["success"],setup(F,{emit:u}){const A=u,t=oe({importType:"",open:!1,loading:!1,step:-1,stepItems:[{title:"预处理"},{title:"验证"},{title:"导入"}],menuMaps:{1:"导入项目表",2:"导入投资事件表",3:"导入备注和飞书链接表",4:"导入第三方项目表"},fileList:[],errorMessage:""}),M=({key:a})=>{t.importType=a,t.errorMessage="",t.fileList=[],t.open=!0},v=async a=>{console.info(a);const d=new FormData;return d.append("file",a),await Pe(d)},P=()=>{const a={};switch(t.importType){case"1":a.fileName="光跃项目模版.xlsx",a.templateUrl="https://gy-static-resource.oss-cn-beijing.aliyuncs.com/%E5%85%89%E8%B7%83%E9%A1%B9%E7%9B%AE%E6%A8%A1%E7%89%88.xlsx",a.preFetchApi=Ge,a.uploadApi=v,a.validateType="project",a.importApi=Fe;break;case"2":a.fileName="光跃投资事件模版.xlsx",a.templateUrl="https://gy-static-resource.oss-cn-beijing.aliyuncs.com/%E5%85%89%E8%B7%83%E6%8A%95%E8%B5%84%E4%BA%8B%E4%BB%B6%E6%A8%A1%E7%89%88.xlsx",a.preFetchApi=Je,a.uploadApi=v,a.validateType="investment",a.importApi=Ie;break;case"3":a.fileName="光跃项目备注和飞书链接模版.xlsx",a.templateUrl="https://gy-static-resource.oss-cn-beijing.aliyuncs.com/%E5%85%89%E8%B7%83%E9%A1%B9%E7%9B%AE%E5%A4%87%E6%B3%A8%E9%93%BE%E6%8E%A5%E6%A8%A1%E7%89%88.xlsx",a.preFetchApi=Qe,a.uploadApi=v,a.validateType="memo",a.importApi=Ae;case"4":a.fileName="第三方项目表模版.xlsx",a.templateUrl="https://gy-static-resource.oss-cn-beijing.aliyuncs.com/%E7%AC%AC%E4%B8%89%E6%96%B9%E9%A1%B9%E7%9B%AE%E4%BF%A1%E6%81%AF%E5%AF%BC%E5%85%A5%E6%A8%A1%E6%9D%BF.xlsx",a.preFetchApi=Xe,a.uploadApi=v,a.validateType="third_project",a.importApi=Me;break}return a},j=()=>{const a=P();let d=a.templateUrl,f=a.fileName;const L=document.createElement("a");L.style.display="none",L.setAttribute("href",d),L.setAttribute("download",f||"template.pdf"),document.body.appendChild(L),L.click(),document.body.removeChild(L)},e=()=>{t.fileList=[],t.step=-1,t.errorMessage=null,t.open=!1},I=()=>{e()},$=async a=>{const{file:d,onSuccess:f,onError:L}=a;try{t.fileList=[{uid:"1",name:d.name,status:"uploading",originFileObj:d}],f(d),t.step=0}catch{t.errorMessage="文件处理失败",L(new Error("File processing failed"))}},q=()=>{t.stepItems=t.stepItems.map((a,d)=>({...a,status:d===t.step?"process":d<t.step?"finish":"wait"}))},H=async a=>{t.loading=!0,t.errorMessage=null;const{uploadApi:d}=P();try{const f=await d(a),{result:L}=f;return t.fileList&&t.fileList.length>0&&(t.fileList[0]={...t.fileList[0],fileName:L}),L}catch(f){throw t.errorMessage="上传失败",f}finally{t.loading=!1}},C=async a=>{const{preFetchApi:d}=P();if(!d){t.step=1;return}t.loading=!0,t.errorMessage=null;try{await d(a.originFileObj||a),await H(a.originFileObj||a),t.step=1}catch{t.errorMessage="预处理失败",t.step=-1,t.loading=!1}finally{t.loading=!1}};async function U(a){console.log(a);const{validateType:d}=P(),f=await Ee({filename:a,type:d});if(d==="project"&&f&&f.success===!1&&f.message.includes("(2)验证失败")){if(!await ee.confirm({centered:!0,title:"验证失败",content:f.message,okButtonProps:{style:{display:"none"}},cancelText:"终止导入"}))return{...f,terminated:!0}}else if(f&&f.success===!1&&!await ee.confirm({title:"验证失败",content:f.message,okText:"继续",cancelText:"终止导入"}))return{...f,terminated:!0};return f}const Z=async()=>{if(!t.fileList||t.fileList.length===0||!t.fileList[0].fileName){t.errorMessage="没有可验证的文件",t.step=-1;return}t.loading=!0;try{const a=await U(t.fileList[0].fileName);if(a&&a.terminated===!0){t.errorMessage="用户已终止验证过程",t.step=-1;return}t.step=2}catch(a){console.log("error :",a),t.loading=!1,t.errorMessage="验证失败.",t.step=-1}finally{t.loading=!1}},G=async()=>{if(!t.fileList||t.fileList.length===0||!t.fileList[0].fileName){t.errorMessage="没有可导入的文件",t.step=-1;return}t.loading=!0;try{const{importApi:a}=P(),d=await a({fileName:t.fileList[0].fileName});t.step=3,e(),ee.success({title:"导入成功",content:d.result||"数据导入成功",okText:"确定"}),A("success",d)}catch{t.errorMessage="导入失败",t.step=-1}finally{t.loading=!1}};return ue(()=>t.step,()=>{q(),t.step===0?t.fileList&&t.fileList.length>0&&C(t.fileList[0]):t.step===1?Z():t.step===2&&G()}),(a,d)=>{const f=k("a-tooltip"),L=k("a-menu-item"),S=k("a-menu"),J=k("a-dropdown"),K=k("a-steps"),Q=k("a-button"),n=k("a-upload"),o=k("a-spin"),s=k("a-modal");return m(),_("div",null,[y(J,null,{overlay:x(()=>[y(S,{class:"custom-menu",onClick:M},{default:x(()=>[(m(!0),_(te,null,se(t.menuMaps,(r,l)=>(m(),W(L,{key:l},{default:x(()=>[O(N(r),1)]),_:2},1024))),128))]),_:1})]),default:x(()=>[y(f,{placement:"top"},{title:x(()=>d[2]||(d[2]=[E("span",null,"导入",-1)])),default:x(()=>[y(b(Oe))]),_:1})]),_:1}),y(s,{class:ne(["sys-modal",t.isFullscreeen?"full-modal":""]),open:t.open,"onUpdate:open":d[1]||(d[1]=r=>t.open=r),confirmLoading:t.loading,width:"520px",centered:"",title:t.menuMaps[t.importType],onOk:I,onCancel:e},{default:x(()=>[E("div",Ye,[E("div",Ze,[y(K,{current:t.step,items:t.stepItems,style:{width:"100%"},class:"steps"},null,8,["current","items"])]),E("div",Ke,[y(n,{"file-list":t.fileList,"onUpdate:fileList":d[0]||(d[0]=r=>t.fileList=r),customRequest:$,"show-upload-list":!0},{default:x(()=>[y(Q,{type:"primary"},{default:x(()=>[y(b(Ne)),d[3]||(d[3]=O(" 上传 "))]),_:1,__:[3]})]),_:1},8,["file-list"]),t.step===0?(m(),_("span",et,"预处理中...")):t.step===1?(m(),_("span",tt,"验证中...")):t.step===2?(m(),_("span",st,"导入中...")):R("",!0),t.loading?(m(),W(o,{key:3})):R("",!0)]),t.errorMessage?(m(),_("div",nt,N(t.errorMessage),1)):R("",!0),E("div",it,[y(Q,{type:"link",onClick:j},{default:x(()=>d[4]||(d[4]=[O("点击下载模版")])),_:1,__:[4]})])])]),_:1},8,["class","open","confirmLoading","title"])])}}},rt=ie(ot,[["__scopeId","data-v-3df9c6c6"]]),at={class:"search"},lt={class:"right"},ct={__name:"search",props:{showImport:{type:Boolean,default:!0},showExport:{type:Boolean,default:!0},showRedo:{type:Boolean,default:!1}},emits:["search","success","export"],setup(F,{emit:u}){const A=u,t=oe({value:""}),M=e=>{console.log(e),A("search",e)},v=()=>{t.value="",A("clearSearch")},P=()=>{A("success")},j=()=>{A("export")};return(e,I)=>{const $=k("a-input-search"),q=k("a-button"),H=k("a-tooltip");return m(),_("div",at,[E("div",null,[y($,{value:t.value,"onUpdate:value":I[0]||(I[0]=C=>t.value=C),placeholder:"全文搜索",style:{width:"300px"},onSearch:M},null,8,["value"]),y(q,{type:"primary",class:"ml-2",icon:me(b(je)),onClick:v},{default:x(()=>I[1]||(I[1]=[O("重置搜索")])),_:1,__:[1]},8,["icon"])]),E("div",lt,[e.$props.showImport?(m(),W(rt,{key:0,onSuccess:P})):R("",!0),e.$props.showExport?(m(),W(H,{key:1,placement:"top"},{title:x(()=>I[2]||(I[2]=[E("span",null,"导出",-1)])),default:x(()=>[y(b($e),{onClick:j})]),_:1})):R("",!0),y(He),e.$props.showRedo?(m(),W(Se,{key:2})):R("",!0)])])}}},Pt=ie(ct,[["__scopeId","data-v-54027b7a"]]),dt={class:"filter-wrap"},pt={key:0,class:"loading"},ut={key:1},mt={class:"flex items-start"},ft={class:"first_introduction_text"},gt={class:""},vt={key:0,class:"plus"},yt={key:1,class:"minus"},_t=["id"],ht=["onClick"],Lt={key:0,class:"common_plus_icon less_btn_icon",style:{position:"relative",top:"0px",right:"0px"}},xt={key:1,class:"common_plus_icon"},Tt={class:"more"},kt={class:"collapse"},wt={__name:"filter",props:{statsMap:{type:Object,default:()=>({})},isOption:{type:Boolean,default:!1},fromWhichComponent:{type:String,default:"project_center"}},emits:["filterChange"],setup(F,{expose:u,emit:A}){const t=fe(),M=A,v=F,P=ge(),{gUserRoles:j}=ve(P),e=oe({isOpen:!0,loading:!1,tooltips:[],selectedDomain1Tags:[],orderMap:{},domainAllList:[],leverList:[{name:"一级赛道",key:"domain1",tags:[],selectedTags:[],showMore:!0},{name:"二级赛道",key:"domain2",tags:[],selectedTags:[],showMore:!0},{name:"三级赛道",key:"domain3",tags:[],selectedTags:[],showMore:!0},{name:"行业等级",key:"priority",tags:[...Re],selectedTags:[],isHide:v.isOption},{name:"轮次",key:"turn2",tags:[...qe],selectedTags:[],isHide:v.isOption},{name:"项目阶段",key:"stage",tags:[...Ue],selectedTags:[],isHide:v.isOption},{name:"跟进状态",key:"followStage",tags:[...Ve],selectedTags:[],isHide:v.isOption},{name:"主理人",key:"main",tags:[],selectedTags:[],isHide:v.isOption},{name:"协理人",key:"assistant",tags:[],selectedTags:[],isHide:v.isOption},{name:"省",key:"provinceMap",isHide:v.isOption||!0,tags:[],selectedTags:[]},{name:"市",key:"cityMap",isHide:v.isOption||!0,tags:[],selectedTags:[]},{name:"区",key:"regionMap",isHide:v.isOption||!0,tags:[],selectedTags:[]}],provinceTags:[],cityTags:[],regionTags:[]}),I=async()=>{await we(),e.leverList.forEach(n=>{const o=document.getElementById(n.key+"-tags");!o||!n.key.includes("domain")||((o==null?void 0:o.scrollHeight)===30?n.showMore=!1:n.showMore=!0)})},$=n=>{if(n===""){for(const s of e.leverList)s.selectedTags=[];C();return}const o=e.leverList.findIndex(s=>s.key===n);if(o!==-1){if(e.leverList[o].selectedTags=[],n.includes("domain")){let r=Number(n.replace("domain",""))+1;for(;r;){const l=e.leverList.findIndex(i=>i.key===`domain${r}`);if(l===-1)break;e.leverList[l].selectedTags=[],r++}S()}else if(["provinceMap","cityMap","regionMap"].includes(n)){if(n==="provinceMap"){const s=e.leverList.findIndex(l=>l.key==="cityMap"),r=e.leverList.findIndex(l=>l.key==="regionMap");s!==-1&&(e.leverList[s].selectedTags=[]),r!==-1&&(e.leverList[r].selectedTags=[])}else if(n==="cityMap"){const s=e.leverList.findIndex(r=>r.key==="regionMap");s!==-1&&(e.leverList[s].selectedTags=[])}U()}C()}},q=(n,o)=>{const s=Number(n.replace("domain","")),r=s-1;if(e.leverList.findIndex(h=>h.key===`domain${r}`)===-1)return;let i=e.domainAllList.filter(h=>h[`domain${s}`]===o),c=1,p="";for(;c<s;){const h=c-1;if(p&&(i=i.filter(B=>B[`domain${h}`]===p)),p=d(Array.from(new Set(i.map(B=>B[`domain${c}`]))))[0],!p)break;e.leverList[h].selectedTags.includes(p)||e.leverList[h].selectedTags.push(p),c++}},H=(n,o)=>{const s=Number(n.replace("domain","")),r=s+1,l=e.leverList.findIndex(c=>c.key===`domain${r}`);if(l===-1||e.leverList[l].selectedTags.length===0)return;const i=e.domainAllList.filter(c=>c[`domain${s}`]===o).map(c=>c[`domain${r}`]);e.leverList[l].selectedTags=e.leverList[l].selectedTags.filter(c=>i.includes(c)?(H(`domain${r}`,c),!1):!0)},C=()=>{const n={},o={allDomain:[...e.domainAllList]};e.leverList.forEach(s=>{s.selectedTags.length&&(n[s.key]=s.selectedTags),o[s.key]=s.tags}),M("filterChange",{filters:n,filterValuesMap:o})};function U(){let n=[],o=[];[...e.domainAllList];const s=e.leverList.findIndex(i=>i.key==="provinceMap"),r=e.leverList.findIndex(i=>i.key==="cityMap"),l=e.leverList.findIndex(i=>i.key==="regionMap");e.leverList[s].selectedTags.length!==0?n=ce(e.leverList[s].selectedTags):n=ce(e.provinceTags),n=Array.from(new Set(n)),e.leverList[r].tags=J(le(n.map(i=>({text:i,value:i})),"text"),"cityMap").map(i=>i.text),e.leverList[r].selectedTags.length!==0?o=de(e.leverList[r].selectedTags):o=de(e.leverList[s].selectedTags.length!==0?n:e.cityTags),o=Array.from(new Set(o)),e.leverList[l].tags=J(le(o.map(i=>({...i,text:i,value:i})),"text"),"regionMap").map(i=>i.text)}const Z=(n,o)=>{const s=e.leverList.findIndex(r=>r.key==="provinceMap");if(n==="cityMap"){const r=pe(o,"city");for(const l of r)e.leverList[s].selectedTags.includes(l[0])||e.leverList[s].selectedTags.push(l[0])}else if(n==="regionMap"){const r=pe(o,"region"),l=e.leverList.findIndex(i=>i.key==="cityMap");for(const i of r)e.leverList[l].selectedTags.includes(i[1])||(e.leverList[l].selectedTags.push(i[1]),!e.leverList[s].selectedTags.includes(i[0])&&e.leverList[s].selectedTags.push(i[0]))}},G=(n,o)=>{const s=e.leverList.findIndex(l=>l.key==="cityMap"),r=e.leverList.findIndex(l=>l.key==="regionMap");if(n==="provinceMap"){const l=ze(o);e.leverList[s].selectedTags=e.leverList[s].selectedTags.filter(i=>l.includes(i)?(G("cityMap",i),!1):!0)}else if(n==="cityMap"){const l=We(o);e.leverList[r].selectedTags=e.leverList[r].selectedTags.filter(i=>!l.includes(i))}},a=(n,o)=>{const s=e.leverList.findIndex(l=>l.key===n);if(s===-1)return;const r=e.leverList[s].selectedTags.findIndex(l=>l===o);r===-1?(e.leverList[s].selectedTags.push(o),n.includes("domain")?q(n,o):["cityMap","regionMap"].includes(n)&&Z(n,o)):(e.leverList[s].selectedTags.splice(r,1),n.includes("domain")?H(n,o):["provinceMap","cityMap"].includes(n)&&G(n,o)),n.includes("domain")?S():["provinceMap","cityMap","regionMap"].includes(n)&&U(),C()};function d(n){return n==null?void 0:n.sort((o,s)=>{let r=e.orderMap[o]?e.orderMap[o].nth:1/0,l=e.orderMap[s]?e.orderMap[s].nth:1/0;return r-l})}function f(n,o){return Array.from(new Set(e.domainAllList.filter(r=>r[`domain${n-1}`]===o).map(r=>r[`domain${n}`])))}const L=(n,o)=>{let s=[];return n==null||n.forEach(r=>{s=s.concat(f(o,r))}),Array.from(new Set(s))};function S(){let n=[],o=[],s=[...e.domainAllList];const r=e.leverList.findIndex(c=>c.key==="domain1"),l=e.leverList.findIndex(c=>c.key==="domain2"),i=e.leverList.findIndex(c=>c.key==="domain3");e.leverList[r].selectedTags.length!==0?(s=s.filter(c=>e.leverList[0].selectedTags.includes(c.domain1)),n=[...e.leverList[r].selectedTags]):n=[...e.leverList[r].tags],e.leverList[l].tags=d(L(n,2)),e.leverList[l].selectedTags.length!==0?(s=s.filter(c=>e.leverList[1].selectedTags.includes(c.domain2)),o=[...e.leverList[l].selectedTags]):o=[...e.leverList[l].tags],e.leverList[i].tags=d(L(o,3)),I()}function J(n,o="",s="value"){return n.sort((r,l)=>{const i=r[s],c=l[s],p=v.statsMap[o+"-"+i]>0,h=v.statsMap[o+"-"+c]>0;return p&&!h?-1:!p&&h?1:i.localeCompare(c,"zh-CN")})}const K=()=>new Promise(async n=>{var o,s,r,l,i,c,p,h,w,B,g,D;try{let T=null;!j.value.includes("mgr")&&!j.value.includes("admin")?v.fromWhichComponent==="project_center"?T=await X("touyan_report_project_field_values_proj_center_dgy"):T=await X("touyan_report_project_field_values_info_center_dgy"):v.fromWhichComponent==="project_center"?T=await X("report_project_field_values_proj_center_gsh"):T=await X("report_project_field_values_info_center_gsh"),e.provinceTags=((l=(r=(s=(o=T==null?void 0:T.result)==null?void 0:o[0])==null?void 0:s.province_values)==null?void 0:r.split(","))==null?void 0:l.map(V=>{let[z,re]=V.split(":");return z}))||[],e.cityTags=((h=(p=(c=(i=T==null?void 0:T.result)==null?void 0:i[0])==null?void 0:c.city_values)==null?void 0:p.split(","))==null?void 0:h.map(V=>{let[z,re]=V.split(":");return z}))||[],e.regionTags=((D=(g=(B=(w=T==null?void 0:T.result)==null?void 0:w[0])==null?void 0:B.region_values)==null?void 0:g.split(","))==null?void 0:D.map(V=>{let[z,re]=V.split(":");return z}))||[],U()}catch(T){console.error(T)}n()}),Q=()=>{e.loading=!0;const n=[];let o=0;return n[o++]=Ce().then(s=>(e.tooltips=s.result||[],Promise.resolve(s))).catch(()=>Promise.resolve({})),n[o++]=Be({pageNo:1,pageSize:1e5}).then(s=>Promise.resolve(s)).catch(()=>Promise.resolve({})),n[o++]=be().then(s=>Promise.resolve(s)).catch(()=>Promise.resolve({})),n[o++]=P.getUserList().then(s=>{var c,p,h;const r=((h=(p=(c=s.filter)==null?void 0:c.call(s,w=>!["管理员rootroot","毛振华","孙婷"].includes(w.realname)))==null?void 0:p.map)==null?void 0:h.call(p,w=>w.realname))||[],l=e.leverList.findIndex(w=>w.key==="main");e.leverList[l].tags=[...r];const i=e.leverList.findIndex(w=>w.key==="assistant");return e.leverList[i].tags=[...r],Promise.resolve(res)}).catch(()=>Promise.resolve({})),n[o++]=K(),Promise.all(n).then(s=>{var h,w,B;let r={};(((h=s[2])==null?void 0:h.result)||[]).forEach(g=>{r[g.name]={...g,nth:g.nth===0||g.name==="未分类I"?1e5:g.nth}});const i=((B=(w=s[1])==null?void 0:w.result)==null?void 0:B.records)||[];e.domainAllList=i,e.orderMap=r;let c=d(Array.from(new Set(i.map(g=>g.domain1)))).map(g=>g);const p=e.leverList.findIndex(g=>g.key==="domain1");if(e.leverList[p].tags=c,S(),t.query.level)switch(Number(t.query.level)){case 1:t.query.domain1&&(e.leverList[p].isHide=!0,e.leverList[p].selectedTags=[t.query.domain1]);break;case 2:t.query.domain1&&t.query.domain2&&(e.leverList[p].isHide=!0,e.leverList[p].selectedTags=[t.query.domain1],e.leverList[p+1].isHide=!0,e.leverList[p+1].selectedTags=[t.query.domain2]);break;case 3:t.query.domain1&&t.query.domain2&&t.query.domain3&&(e.leverList[p].isHide=!0,e.leverList[p].selectedTags=[t.query.domain1],e.leverList[p+1].isHide=!0,e.leverList[p+1].selectedTags=[t.query.domain2],e.leverList[p+2].isHide=!0,e.leverList[p+2].selectedTags=[t.query.domain3]);break}if(t.query.stage){const g=e.leverList.findIndex(D=>D.key==="stage");g!==-1&&(e.leverList[g].selectedTags=[t.query.stage],e.leverList[g].isHide=!0)}if(t.query.followStage){const g=e.leverList.findIndex(D=>D.key==="followStage");g!==-1&&(e.leverList[g].selectedTags=[t.query.followStage],e.leverList[g].isHide=!0)}C()}).finally(()=>(e.loading=!1,Promise.resolve()))};return ye(()=>{const n=[];for(const s in De)n.push(s);const o=e.leverList.findIndex(s=>s.key==="provinceMap");e.leverList[o].tags=[...n],Q(),window.addEventListener("resize",I)}),_e(()=>{window.removeEventListener("resize",I)}),u({getFilterItems:C,handleCheckedTag:a,handleClickAll:$}),(n,o)=>{const s=k("a-spin"),r=k("a-tooltip"),l=k("a-button");return m(),_("div",dt,[e.loading?(m(),_("div",pt,[y(s)])):he((m(),_("div",ut,[(m(!0),_(te,null,se(e.leverList.filter(i=>!i.isHide),i=>(m(),_("div",{class:"common_tab_level",key:i.key},[E("div",mt,[E("div",ft,[E("span",gt,N(i.name),1)]),y(l,{class:"ant-btn-default my_shouqi1",iconsize:"15",isupload:"false",type:"button",onClick:c=>$(i.key)},{default:x(()=>[y(r,{title:b(ae)(e.tooltips,"项目中心","全选")},{default:x(()=>[o[2]||(o[2]=O(" 全选 ")),i.selectedTags.length>0?(m(),_("span",vt,"+")):(m(),_("span",yt,"-"))]),_:2,__:[2]},1032,["title"])]),_:2},1032,["onClick"]),E("div",{id:i.key+"-tags",class:ne(["flex-row","filter-tags",!i.showMore||i.showAll?"all":""])},[(m(!0),_(te,null,se(i.tags,c=>(m(),_("span",{key:c,class:ne(["filter-tag",i.key.includes("domain")?"classic":"",i.selectedTags.includes(c)?"active":""]),onClick:p=>a(i.key,c)},N(c)+"("+N(v.statsMap[i.key+"-"+c]||0)+")",11,ht))),128))],10,_t),y(l,{class:"my_shouqi",type:"link",style:xe({visibility:i.showMore?"visible":"hidden"}),onClick:c=>i.showAll=!i.showAll},{default:x(()=>[y(r,{title:b(ae)(e.tooltips,"项目中心",i.showAll?"收起":"更多")},{default:x(()=>[i.showAll?(m(),_("span",Lt,"- ")):(m(),_("span",xt,"+ ")),E("span",Tt,N(i.showAll?"收起":"更多"),1)]),_:2},1032,["title"])]),_:2},1032,["style","onClick"])])]))),128))],512)),[[Le,e.isOpen]]),E("div",kt,[e.isOpen?(m(),_("div",{key:0,class:"title",onClick:o[0]||(o[0]=i=>e.isOpen=!1)},[y(b(Te)),o[3]||(o[3]=O(" 收起 "))])):(m(),_("div",{key:1,class:"title",onClick:o[1]||(o[1]=i=>e.isOpen=!0)},[y(b(ke)),o[4]||(o[4]=O(" 展开 "))]))])])}}},Ct=ie(wt,[["__scopeId","data-v-dcee40e8"]]);export{Ct as F,Pt as S};
