import{u as R,Q as y,R as o,S as d,T as E,U as L}from"./index-DgoLVYM5.js";function B(){const n=R(),u=y();let c={};function m(e){c=e}const p=()=>{u.setHistoryRoutes([])};function f(e,r){let t=[],i=c.permissionList;if(i&&i.length>0)for(let s of i)s.type==r&&t.push(s.action);return t.indexOf(e)>=0}async function A(){u.setProjectConfig({permissionMode:u.projectSetting.permissionMode===o.BACK?o.ROUTE_MAPPING:o.BACK}),location.reload()}async function a(){E(),(await n.buildRoutesAction()).forEach(r=>{L.addRoute(r)}),n.setLastBuildMenuTime(),p()}function l(e,r=!0){var i;if(!e)return r;const t=u.projectSetting.permissionMode;if([o.ROUTE_MAPPING,o.ROLE].includes(t))return Array.isArray(e)?d(e,n.gUserRoles).length>0:(i=n.gUserRoles)==null?void 0:i.includes(e);if(o.BACK===t){const s=n.premissionCodeList;return!Array.isArray(e)&&s&&s.length>0?c&&f(e,"1")===!0?!0:s.includes(e):d(e,s).length>0}return!0}function g(e,r=!0){if(c){let t=e;if(f(t,"2")===!0)return!0;if(M(t)==!0)return!1}return!l(e)}async function h(e){if(u.projectSetting.permissionMode!==o.ROUTE_MAPPING)throw new Error("Please switch PermissionModeEnum to ROUTE_MAPPING mode in the configuration to operate!");Array.isArray(e)||(e=[e]),n.setRoleList(e),await a()}async function P(){a()}function M(e){let r=n.allAuthList;if(r&&r instanceof Array){let t=r.filter(i=>i.action==e);if(t&&t.length>0){if(t[0].status=="0")return!0}else return!0}return!1}return{changeRole:h,hasPermission:l,togglePermissionMode:A,refreshMenu:P,isDisabledAuth:g,initBpmFormData:m}}export{B as u};
